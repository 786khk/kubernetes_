
# Service
- 쿠버네티스 네트워크
- 가장 어렵다고 느끼는 파트. 
-  구성
   - 서비스 IP 주소
   - 서비스 디스커버리 : label selector를 사용해 탐색, 클라이언트 요청을 적절한 타드로 라우팅
   - 서비스 타입 :  클러스터 내부,외부 통신을 위해 여러 타입을 가진다.
## 개념
- 동일한 서비스를 제공하는 pOD그룹의 단일 진입점 제공
- 웹서버 3개실행하라 는 요청이 오면 
- 순서 : api가 요청을 받고 문법체크 후 컨트롤러, ETCD에 있는 NODE1,2,3에 있는 정보 수집해 ETDC에 보존, 스케줄러로 요청이온 서비스 3개 실행

  - 컨트롤러가 갯수 보존, 이 때 동일한 같은 일을 하는 파드 3개 > IP는 환경에 따라 대역이 달라짐
  - 이 때 하나의 파드에만 모든 작업이 집중되면 옳지 않음, 3개의 파드가 있다면 3개의 파트에 균등하게 나눠서 작업하도록 해준다. 
  - api SERVICE 로 3개의 파드에 대해 당일진입점을 만들어달라는 요청이 오면 POD의 LABEL을 가지고 하나로 묶어줌
  - 이 때 LOAD BALANCER(작업을 균등하게 분산해 실핼하도록) 를 만들어서 ETCD에 기록
```yaml

apiVersion: apps/v1
kind: Deployment
metadata:
  name: myApp
spec: 
  replicas: 3
  selector:
    matchedLabels:
      app: myApp
  template:
    metadata:
      name: nginx-pod
      labels:
        app: myApp # app=myApp이라는 셀렉터를 가진 서비스 찾아 단일진입전 만들어줘.

...

```

```yaml

apiVersion: v1
kind: Service
metadata:
  name: myApp-svc
spec: 
  clusterIp: 10.96.100.100 # 가상IP, 로드밸런서 IP
  selector:
    matchedLabels:
      app: myApp

...

```



## 타입

### ClusterIP
- pod그룹의 단일진입점
- 서비스 생성요청시 가상의 IP가 만들어지고 동일한목적, 라벨을 가진파드를 연결해 운영(서비스 기본개념)
### NodePort
- ClusterIP 를 포함(기본적으로 )생성
- 각 worker의 port오픈됨
- 파드의 포트를 동일한 포트로 오픈
- 
### LoadBalacer
- 서비스 요청이 오면 ClusterIP + Nodepoter 
### ExternalName



## 사용법

## 헤드리스 서비스

## KUBE-PROXY


